#include <stdio.h>
#include <stdlib.h> 
#include <math.h>			//引入头文件

typedef double y[58]; //an,un的状态方程参数
typedef double fea[21]; //特征参数,二元交互作用参数值,
typedef long   x[58];  //其他状态方程参数（bn,cn,kn,gn,qn,fn,sn,wn数据）


//表1-10 状态方程参数
y a = { 0.153832600,  1.341953000, -2.998583000, -0.048312280,  0.375796500, -1.589575000, -0.053588470,  0.886594630, -0.710237040, -1.471722000,
        1.321850350, -0.786659250,  0.2291290e-8, 0.157672400, -0.436386400, -0.044081590, -0.003433888,  0.032059050,  0.024873550,  0.073322790,
        -0.001600573,  0.642470600, -0.416260100, -0.066899570,  0.279179500, -0.696605100, -0.002860589, -0.008098836,  3.150547000,  0.007224479,
        -0.705752900,  0.534979200, -0.079314910, -1.418465000, -0.599905e-16, 0.105840200,  0.034317290, -0.007022847,  0.024955870,  0.042968180,
        0.746545300, -0.291961300,  7.294616000, -9.936757000, -0.005399808, -0.243256700,  0.049870160,  0.003733797,  1.874951000,  0.002168144,
        -0.658716400,  0.000205518,  0.009776195, -0.020487080,  0.015573220,  0.006862415, -0.001226752,  0.002850908};  //an数据

y u = { 0.0,0.5,1.0,3.5,-0.5,4.5,0.5,7.5,9.5,6.0,12.0,12.5,-6.0,2.0,3.0,2.0,2.0,11.0,-0.5,0.5,0.0,4.0,6.0,21.0,23.0,22.0,-1.0,-0.5,7.0,
         -1.0,6.0,4.0,1.0,9.0,-13.0,21.0,8.0,-0.5,0.0,2.0,7.0,9.0,22.0,23.0,1.0,9.0,3.0,8.0,23.0,1.5,5.0,-0.5,4.0,7.0,3.0,0.0,1.0,0.0 };//un数据

x b = { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,5,5,5,5,5,6,6,7,7,8,8,8,9,9 };
x c = { 0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,1,1,1,1,0,1,0,1,1,1,1,1,1 };
x k = { 0,0,0,0,0,0,0,0,0,0,0,0,3,2,2,2,4,4,0,0,2,2,2,4,4,4,4,0,1,1,2,2,3,3,4,4,4,0,0,2,2,2,4,4,0,2,2,4,4,0,2,0,2,1,2,2,2,2 };
x g = { 0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0,0 };
x q = { 0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,1,0,0,1,0,0,0,0,0,1 };
x f = { 0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };
x s = { 0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };
x w = { 0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 }; //bn,cn,kn,gn,qn,fn,sn,wn数据


//表1-12 特征参数
fea Mi = { 16.0430,28.0135,44.0100,30.0700,44.0970,18.0153,34.0820,2.0159,28.0100,31.9988,58.1230,58.1230,72.1500,72.1500,86.1770,100.2040,114.2310,128.2580,142.2850,4.0026,39.9480 };
fea Ei = { 151.318300, 99.737780,241.960600,244.166700,298.118300,514.015600,296.355000, 26.957940,105.534800,122.766700,324.068900,337.638900,365.599900,370.682300,402.636293,427.722630,450.325022,470.840891,489.558373,  2.610111,119.629900 };
fea Ki = { 0.4619255,0.4479153,0.4557489,0.5279209,0.5837490,0.3825868,0.4618263,0.3514916,0.4533894,0.4186954,0.6406937,0.6341423,0.6738577,0.6798307,0.7175118,0.7525189,0.7849550,0.8152731,0.8437826,0.3589888,0.4216551 };
fea Gi = { 0.000000,0.027815,0.189065,0.079300,0.141239,0.332500,0.088500,0.034369,0.038953,0.021000,0.256692,0.281835,0.332267,0.366911,0.289731,0.337542,0.383381,0.427354,0.469659,0.000000,0.000000 };
fea Qi = { 0.0,0.0,0.69,0.0,0.0,1.06775,0.633276,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0 };
fea Fi = { 0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0 };
fea Si = { 0.0,0.0,0.0,0.0,0.0,1.5822,0.390,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0 };
fea Wi = { 0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0 };


//表1-11 二元交互作用参数值
fea EIJ[21] = {
  { 1.000000,0.971640,0.960644,1.000000,0.994635,0.708218,0.931484,1.170520,0.990126,1.000000,1.019530,0.989844,1.002350,0.999268,1.107274,0.880880,0.880973,0.881067,0.881161,1.000000,1.000000},
  { 1.000000,1.000000,1.022740,0.970120,0.945939,0.746954,0.902271,1.086320,1.005710,1.021000,0.946914,0.973384,0.959340,0.945520,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,0.925053,0.960237,0.849408,0.955052,1.281790,1.500000,1.000000,0.906849,0.897362,0.726255,0.859764,0.855134,0.831229,0.808310,0.786323,0.765171,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.022560,0.693168,0.946871,1.164460,1.000000,1.000000,1.000000,1.013060,1.000000,1.005320,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.034787,1.000000,1.000000,1.000000,1.004900,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.008692,1.010126,1.011501,1.012821,1.014089,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.100000,1.000000,1.300000,1.300000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  { 1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000} };

fea UIJ[21] = {
  {1.000000,0.886106,0.963827,1.000000,0.990877,1.000000,0.736833,1.156390,1.000000,1.000000,1.000000,0.992291,1.000000,1.003670,1.302576,1.191904,1.205769,1.219634,1.233498,1.000000,1.000000},
  {1.000000,1.000000,0.835058,0.816431,0.915502,1.000000,0.993476,0.408838,1.000000,1.000000,1.000000,0.993556,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,0.969870,1.000000,1.000000,1.045290,1.000000,0.900000,1.000000,1.000000,1.000000,1.000000,1.000000,1.066638,1.077634,1.088178,1.098291,1.108021,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.065173,1.000000,0.971926,1.616660,1.000000,1.000000,1.250000,1.250000,1.250000,1.250000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.028973,1.033754,1.038338,1.042735,1.046966,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000} };

fea KIJ[21] = {
  {1.000000,1.003630,0.995933,1.000000,1.007619,1.000000,1.000080,1.023260,1.000000,1.000000,1.000000,0.997596,1.000000,1.002529,0.982962,0.983565,0.982707,0.981849,0.980991,1.000000,1.000000},
  {1.000000,1.000000,0.982361,1.007960,1.000000,1.000000,0.942596,1.032270,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.008510,1.000000,1.000000,1.007790,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,0.910183,0.895362,0.881152,0.867520,0.854406,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,0.986893,1.000000,0.999969,1.020340,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,0.968130,0.962870,0.957828,0.952441,0.948338,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000} };

fea GIJ[21] = {
  {1.000000,1.000000,0.807653,1.000000,1.000000,1.000000,1.000000,1.957310,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,0.982746,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,0.370296,1.000000,1.673090,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000},
  {1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000,1.000000} };


double RM = 8.31451e-3;    //定义通用气体常数RM

double BI[18];      //
double CNS[58];
double K1;


void QCNS(fea XJ)

{
    long   I, J, N;
    fea    XI;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
    double SUM = 0.0, U1 = 0.0, G1 = 0.0, Q1 = 0.0, F1 = 0.0, E1 = 0.0;			//定义参数 
    double XIJ, EIJ0, GIJ0, BN;

    for (J = 0; J <= 20; J++) 
	XI[J] = XJ[J];

    /*.....使摩尔分数正常化 */
    for (I = 0; I <= 20; I++) 
	SUM += XI[I];
    for (I = 0; I <= 20; I++) 
	XI[I] /= SUM;

    /*.....标准摩尔气体常数 */
    RM = 8.31451e-3;

    for (N = 0; N <= 17; N++) 
	BI[N] = 0.0;

    K1 = 0.0;

    for (I = 0; I < 21; I++)
    {
        K1 += XI[I] * pow(Ki[I], 2.5);                                                     // B.11
        U1 += XI[I] * pow(Ei[I], 2.5);                                                     // B.6
        G1 += XI[I] * Gi[I];                                                              // B.7
        Q1 += XI[I] * Qi[I];                                                              // 1-48 
        F1 += XI[I] * XI[I] * Fi[I];                                                      // 书1-49
        E1 += XI[I] * Ei[I];
    }

    K1 *= K1;                                                                         // B.11
    U1 *= U1;                                                                         // B.6


    for (I = 0; I < 20; I++)
    {
        for (J = I + 1; J < 21; J++)
        {
            XIJ = XI[I] * XI[J];
            if (XIJ != 0)
            {
                K1 += 2.0 * XIJ * (pow(KIJ[I][J], 5.0) - 1.0) * pow(Ki[I] * Ki[J], 2.5);    	 //          
                U1 += 2.0 * XIJ * (pow(UIJ[I][J], 5.0) - 1.0) * pow(Ei[I] * Ei[J], 2.5);     	//1-46l           
                G1 += XIJ * (GIJ[I][J] - 1.0) * (Gi[I] + Gi[J]);								//1-47
            }
        }
    }                                 // 计算K-混合物参数U,G,Q

    for (I = 0; I < 21; I++)
    {
        for (J = I; J < 21; J++)
        {
            XIJ = XI[I] * XI[J];
            if (XIJ != 0)
            {
                if (I != J) XIJ = 2 * XIJ;
                EIJ0 = EIJ[I][J] * sqrt(Ei[I] * Ei[J]);                                  			// 书1-43
                GIJ0 = GIJ[I][J] * (Gi[I] + Gi[J]) / 2.0;                                     		 // 书1-44
                for (N = 0; N <= 17; N++)
                {
                    BN = pow(GIJ0 + 1.0 - g[N], (double)g[N]) *                                       
                        pow(Qi[I] * Qi[J] + 1.0 - q[N], (double)q[N]) *
                        pow(sqrt(Fi[I] * Fi[J]) + 1.0 - f[N], (double)f[N]) *
                        pow(Si[I] * Si[J] + 1.0 - s[N], (double)s[N]) *
                        pow(Wi[I] * Wi[J] + 1.0 - w[N], (double)w[N]);         					 //书1-42
                    BI[N] += a[N] * XIJ * pow(EIJ0, u[N]) * pow(Ki[I] * Ki[J], 1.5) * BN;       //书1-41             
                }
            }
        }
    }               																			// 计算B-第二维利系数

    K1 = pow(K1, 0.2);                                                                  
    U1 = pow(U1, 0.2);                                                                  
    for (N = 12; N < 58; N++)
        CNS[N] = pow(G1 + 1.0 - g[N], (double)g[N]) * pow(Q1 * Q1 + 1.0 - q[N], (double)q[N]) * pow(F1 + 1.0 - f[N], (double)f[N]) * a[N] * pow(U1, u[N]);				//1-45
}


void PZOFDT(double* D, double* T, double* P, double* Z, double* BMIX)
{
    long N;
    double DR;

    DR = *D * K1 * K1 * K1;   															//DR即ρr                                                               
    *BMIX = 0.0;																		//Bρm 
    for (N = 0; N < 18; N++) *BMIX += BI[N] / pow(*T, u[N]);                                  
    *Z = 1.0 + *BMIX * *D;                                                             
    for (N = 12; N < 18; N++) 
	*Z -= DR * CNS[N] / pow(*T, u[N]);                                
    for (N = 12; N < 58; N++)
        *Z += CNS[N] / pow(*T, u[N]) * (b[N] - c[N] * k[N] * pow(DR, (double)k[N])) * pow(DR, (double)b[N]) * exp(-c[N] * pow(DR, (double)k[N]));
    *P = *D * RM * *T * *Z;
}


void QZOFPT(double* P, double* T, double* D, double* Z, double* BMIX)
{
    long I;
    double X1 = 1e-6, X2 = 40.0;	//条件
    double X3, F, F1, F2, F3;
    double TOL = 0.5e-9;			 
    *D = 0.0;
    PZOFDT(&X1, T, &F1, Z, BMIX);
    PZOFDT(&X2, T, &F2, Z, BMIX);
    F1 -= *P;
    F2 -= *P;
    if (F1 * F2 >= 0) return;

    //------------------
    // 开始迭代
    //------------------
    for (I = 1; I <= 50; I++)
        // 使用错误位置获得点 3。
    {
        X3 = X1 - F1 * (X2 - X1) / (F2 - F1);
        PZOFDT(&X3, T, &F3, Z, BMIX);
        F3 -= *P;
        // 使用点 1、2 和 3 使用 Chamber 方法（二次解）估计根。
        *D = X1 * F2 * F3 / ((F1 - F2) * (F1 - F3)) + X2 * F1 * F3 / ((F2 - F1) * (F2 - F3)) + X3 * F1 * F2 / ((F3 - F1) * (F3 - F2));
        if ((*D - X1) * (*D - X2) >= 0) *D = (X1 + X2) / 2;
        PZOFDT(D, T, &F, Z, BMIX);
        F -= *P;
        if (fabs(F) <= TOL) return;
        // 如果假根(位置)更近，则丢弃二次解。
        if (fabs(F3) < fabs(F) && F * F3 > 0)
        {
            if (F3 * F1 > 0) { X1 = X3; F1 = F3; }
            else { X2 = X3; F2 = F3; }
        }
        else
        // 从二次解换入新值
        {
            if (F * F3 < 0) { X1 = *D; F1 = F; X2 = X3; F2 = F3; }
            else if (F3 * F1 > 0) { X1 = *D; F1 = F; }
            else { X2 = *D; F2 = F; }
        }
    }
    *D = 0.0;
};



int main()

{
    double TT, D, Z, BMIX;			//定义
	
	double Pcm=0,Tcm=0;
	double Pr,Tr;
	double a[21]={0.9650, 0.0030, 0.0060, 0.0180, 0.0045, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0010, 0.0010, 0.0005, 0.0003, 0.0007, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000};
	double b[21]={0.9070, 0.0310, 0.0050, 0.0450, 0.0084, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0010, 0.0015, 0.0003, 0.0004, 0.0004, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000};
	double c[21]={0.8590, 0.0100, 0.0150, 0.0850, 0.0230, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0035, 0.0035, 0.0005, 0.0005, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000};
	double d[21]={0.7350, 0.1000, 0.0160, 0.0330, 0.0074, 0.0000, 0.0000, 0.0950, 0.0100, 0.0000, 0.0012, 0.0012, 0.0004, 0.0004, 0.0002, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000};
	double e[21]={0.8120, 0.0570, 0.0760, 0.0430, 0.0090, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0015, 0.0015, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000};
	double f[21]={0.8260, 0.1170, 0.0110, 0.0350, 0.0075, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0012, 0.0012, 0.0004, 0.0004, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000};
	double P[21];
	double T[21];
	P[0]=46.04;
	P[2]=73.8243    ;//CO2
	P[3]=48.8;
	P[4]=42.5;
	P[7]=12.97    ;//H2
	P[8]=  35 ;//CO
	P[10]=  36.5 ;//i-C4H10
	P[11]=37.97;
	P[12]=33.3    ;//i-C5H12
	P[13] =33.69;
	P[14]=30.12;
	P[15]=27.36;
	P[16]=24.87;
	T[0]=190.69;
	T[2]=304.35;//CO2
	T[3]=305.38;
	T[4]=369.89;
	T[7]=33.19;//H2
	T[8]=132.92   ;//CO
	T[10]= 408.15  ;//i-C4H10
	T[11]=425.18;
	T[12]=460.95 ;//i-C5H12
	T[13] =469.69;
	T[14]=507.28;
	T[15]=540.28;
	T[16]=568.58;
	int i;
	int n;
	printf("几号气体：");
	scanf("%d",&n);
	if(n!=1&&n!=2&&n!=3&&n!=4&&n!=5&&n!=6)
	{
		printf("Error");
		exit (0);
	}
    static fea ex1[6] =
    {
	 { 0.9650, 0.0030, 0.0060, 0.0180, 0.0045, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0010, 0.0010, 0.0005, 0.0003, 0.0007, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000 },
    { 0.9070, 0.0310, 0.0050, 0.0450, 0.0084, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0010, 0.0015, 0.0003, 0.0004, 0.0004, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000 },
    { 0.8590, 0.0100, 0.0150, 0.0850, 0.0230, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0035, 0.0035, 0.0005, 0.0005, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000 },
    { 0.7350, 0.1000, 0.0160, 0.0330, 0.0074, 0.0000, 0.0000, 0.0950, 0.0100, 0.0000, 0.0012, 0.0012, 0.0004, 0.0004, 0.0002, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000 },
    { 0.8120, 0.0570, 0.0760, 0.0430, 0.0090, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0015, 0.0015, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000 },
    { 0.8260, 0.1170, 0.0110, 0.0350, 0.0075, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0012, 0.0012, 0.0004, 0.0004, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000 } 
	};//在此输入体积分数！！！！ 
//CH4      N2      CO2     C2H6    C3H8    H2O     H2S     H2      CO      O2      I-C4H10 N-C4H10 I-C5H12 N-C5H12 C6H14   C7H16   C8H18   C9H2O   C10H22  He      Ar
	
	double t,p;
	printf("压力(单位MPa)：\n");
	scanf("%lf",&p);
	printf("温度(单位K)：\n");
	scanf("%lf",&t);
	
	//选择 
	if(n==1){
		for(i=0;i<21;i++)
		{
			Pcm+=P[i]*a[i];
			Tcm+=T[i]*a[i];
		}
		Pr=p/Pcm*10;
		Tr=t/Tcm;	
	}
	else if(n==2){
		for(i=0;i<21;i++)
		{
			Pcm+=P[i]*b[i];
			Tcm+=T[i]*b[i];
		}
		Pr=p/Pcm*10;
		Tr=t/Tcm;
	}
	else if(n==3){
		for(i=0;i<21;i++)
		{
			Pcm+=P[i]*c[i];
			Tcm+=T[i]*c[i];
		}
		Pr=p/Pcm*10;
		Tr=t/Tcm;
	}
	else if(n==4){
		for(i=0;i<21;i++)
		{
			Pcm+=P[i]*d[i];
			Tcm+=T[i]*d[i];
		}
		Pr=p/Pcm*10;
		Tr=t/Tcm;
	}
	else if(n==5){
		for(i=0;i<21;i++)
		{
			Pcm+=P[i]*e[i];
			Tcm+=T[i]*e[i];
		}
		Pr=p/Pcm*10;
		Tr=t/Tcm;
	}
	else if(n==6){
		for(i=0;i<21;i++)
		{
			Pcm+=P[i]*f[i];
			Tcm+=T[i]*f[i];
		}
		Pr=p/Pcm*10;
		Tr=t/Tcm;
	}

    printf("     P         T         Z         Pr         Tr\n");
    printf(" -----------------------------------------------\n");
    printf("%7.2fMpa %7.2fK", p, t);
    QCNS(ex1[n-1]);  TT = t;
    QZOFPT(&p, &TT, &D, &Z, &BMIX);
    printf("%11.5f", Z);
    printf("%9.2f %9.2f",Pr,Tr);
    printf("\n");
}
